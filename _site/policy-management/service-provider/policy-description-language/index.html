<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, maximum-scale=1, minimum-scale=1">

  <title>reThink Policy Description Language</title>
  <meta name="description" content="reTHINK Framework provides the tools to build a global real-time decentralized communication infra-structure where services are inherently inter-operable.">

  <link rel="canonical" href="http://localhost:4000/specs/policy-management/service-provider/policy-description-language/">
  <link rel="alternate" type="application/rss+xml" title="reThink Framework Specifications" href="/specs/feed.xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <!-- CSS -->
  <link rel="stylesheet" href="/specs/assets/main.css">
  <link rel="stylesheet" href="/css/owl.carousel.css" />
  <link rel="stylesheet" href="/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/css/font-awesome.min.css" />
  <link rel="stylesheet" href="/css/airspace.css" />
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/ionicons.min.css" />
  <link rel="stylesheet" href="/css/animate.css" />
  <link rel="stylesheet" href="/css/responsive.css" />
  <link rel="stylesheet" href="/css/syntax.css" />
  <link rel="stylesheet" href="/css/prism.css" />

  <link rel="stylesheet" href="/css/rethink.css" />

  <!-- Js -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/owl.carousel.min.js"></script>
  <script src="/js/plugins.js"></script>
  <script src="/js/min/waypoints.min.js"></script>
  <script src="/js/jquery.counterup.js"></script>
  <script src="/js/prism.js"></script>

  <script src="/js/main.js"></script>

  <!--
  /*
   * Airspace
   * Ported to Jekyll by Andrew Lee
   * https://github.com/luminousrubyist/airspace-jekyll
   * Designed and Developed by ThemeFisher
   * https://themefisher.com/
   *
   */
  -->

  
</head>


  <body>

    <!-- Header Start -->
<header class="sticky-top" role="banner">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <!-- header Nav Start -->
        <nav class="navbar navbar-default">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              
              <a class="site-title" title="Worldwide real-time decentralized communication infra-structure" href="/specs/"><img src="/specs/img/logo.png" alt="reThink Framework Specifications"></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              
                <ul class="nav navbar-nav navbar-right">
                  
                    
                    
                    <li><a class="page-link" href="/specs/documentation/">Documentation</a></li>
                    
                  
                </ul>
              
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
    </div>
  </div>
</header><!-- header close -->


    <div class="row">

  <!--    <div class="sidebar col-sm-3">
        

        
        <ul style="padding-top: 25px;">
        
          <!-- <p class="category">Getting Started</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/tutorials/development-of-apps/" class="doc-link" role="link">  How to use Hyperties in Applications </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/development-of-hyperties/" class="doc-link" role="link">  How to develop new Hyperties </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/development-of-idp-proxies/" class="doc-link" role="link">  How to develop new Idp Proxies </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/development-of-protostubs/" class="doc-link" role="link">  How to develop new Protostubs </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/hyperty/" class="doc-link" role="link">  Hyper-linked Entities - Hyperties </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/msg-node-development-recommendations/" class="doc-link" role="link">  How to develop Message Nodes </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/p2p-data-sync/" class="doc-link" role="link">  P2P Data Synchronization </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/tutorials/protofly/" class="doc-link" role="link">  Protocol on-the-fly </a>
                
              </li>
            

        
          <!-- <p class="category">APIs</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/service-framework/discovery/" class="doc-link" role="link">  Discovery API </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/service-framework/identity-manager/" class="doc-link" role="link">  Identity Manager API </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/service-framework/readme/" class="doc-link" role="link">  APIs for Hyperties </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/service-framework/syncher/" class="doc-link" role="link">  Syncher API </a>
                
              </li>
            

        
          <!-- <p class="category">Messaging Framework</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/messaging-framework/msg-node-design/" class="doc-link" role="link">  Message Node and Protostubs design recommendations </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messaging-framework/msg-node/" class="doc-link" role="link">  Messaging Node </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messaging-framework/p2p-msg-delivery/" class="doc-link" role="link">  P2P Message Delivery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messaging-framework/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messaging-framework/stub-specification/" class="doc-link" role="link">  Protostub specification </a>
                
              </li>
            

        
          <!-- <p class="category">Runtime</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/runtime/readme/" class="doc-link" role="link">  Runtime Architecture </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/runtime/securityanalysis/" class="doc-link" role="link">  Runtime Security </a>
                
              </li>
            

        
          <!-- <p class="category">Trust Management</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/trust-management/mutual-authentication/" class="doc-link" role="link">  Mutual Authentication </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/trust-management/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/trust-management/secure-communication/" class="doc-link" role="link">  Secured communications </a>
                
              </li>
            

        
          <!-- <p class="category">How it Works - Basics</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/allocate-address/" class="doc-link" role="link">  Address Allocation </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/bus-msg-routing/" class="doc-link" role="link">  Message Routing </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/deploy-hyperty/" class="doc-link" role="link">  Hyperty Deployment </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/deploy-protostub/" class="doc-link" role="link">  Protocol Stub Deployment </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/deploy-runtime/" class="doc-link" role="link">  Runtime Deployment </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/inter-remote-comm/" class="doc-link" role="link">  Cross Domain Msg delivery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/intra-local-comm/" class="doc-link" role="link">  Intra-runtime Msg Delivery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/intra-remote-comm/" class="doc-link" role="link">  Inter-runtime Msg delivery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/p2p-setup/" class="doc-link" role="link">  P2P Msg delivery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/register-hyperty/" class="doc-link" role="link">  Hyperty Registration </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/basics/resolve-routing-address/" class="doc-link" role="link">  Routing Address Resolve </a>
                
              </li>
            

        
          <!-- <p class="category">How it Works - Data Synchronization</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-child/" class="doc-link" role="link">  Data Object Child </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-creation/" class="doc-link" role="link">  Data Object Creation </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-delete/" class="doc-link" role="link">  Data Object Delete </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-reporter-delegation/" class="doc-link" role="link">  Data Object Reporter Delegation </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-subscription/" class="doc-link" role="link">  Data Object Subscription </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/data-object-unsubscription/" class="doc-link" role="link">  Data Object Unsubscription </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/observer-unsubscribed-by-reporter/" class="doc-link" role="link">  Observer unsubscribed by Reporter </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/observers-data-object-resume/" class="doc-link" role="link">  Data Sync Resume for Observers </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/data-sync/reporters-data-object-resume/" class="doc-link" role="link">  Data Sync Resume for Reporters </a>
                
              </li>
            

        
          <!-- <p class="category">How it Works - Discovery</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/discovery/hyperty-discovery/" class="doc-link" role="link">  Data Sync Resume for Observers </a>
                
              </li>
            

        
          <!-- <p class="category">How it Works - Identity Management</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/identity-management/domain-login/" class="doc-link" role="link">  Domain Login </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/identity-management/rt-login/" class="doc-link" role="link">  Id Token generation </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/identity-management/user-identity-assertion/" class="doc-link" role="link">  User identity assertion </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/identity-management/user-to-hyperty-binding/" class="doc-link" role="link">  Identity Binding </a>
                
              </li>
            

        
          <!-- <p class="category">How it Works - Legacy Interworking</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/dynamic-view/legacy-interworking/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            

        
          <!-- <p class="category">Core Datamodel</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/hyperty-resource/readme/" class="doc-link" role="link">  Hyperty Resource </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/hyperty-catalogue/readme/" class="doc-link" role="link">  Hyperty Catalogue </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/data-synch/readme/" class="doc-link" role="link">  Data Object </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/user-identity/readme/" class="doc-link" role="link">  Identity </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/message/readme/" class="doc-link" role="link">  Message </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/hyperty-registry/readme/" class="doc-link" role="link">  Hyperty Registry </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/core/address/readme/" class="doc-link" role="link">  Address Model </a>
                
              </li>
            

        
          <!-- <p class="category">Data Object Models</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/datamodel/data-objects/communication/readme/" class="doc-link" role="link">  Communication Data Object </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/data-objects/connection/readme/" class="doc-link" role="link">  Connection Data Object </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/data-objects/databackup/readme/" class="doc-link" role="link">  Databackup Data Object </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/datamodel/data-objects/context/readme/" class="doc-link" role="link">  Context Data Object </a>
                
              </li>
            

        
          <!-- <p class="category">Messages Specification</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/messages/address-allocation-messages/" class="doc-link" role="link">  Address Allocation </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/data-sync-messages/" class="doc-link" role="link">  Data Object Synchronization </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/discovery-messages/" class="doc-link" role="link">  Discovery </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/identity-management-messages/" class="doc-link" role="link">  Identity Management </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/p2p-connection-messages/" class="doc-link" role="link">  P2P Connections Management </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/readme/" class="doc-link" role="link">  Overview </a>
                
              </li>
            
              <li>
                
                  <a href="/specs/specs/messages/registration-messages/" class="doc-link" role="link">  Registration </a>
                
              </li>
            

        
          <!-- <p class="category">Backend Deployment</p> -->

          <!--  
            
              <li>
                
                  <a href="/specs/specs/deployment/readme/" class="doc-link" role="link">  Quick installation guide </a>
                
              </li>
            

        
        </ul>
      </div> -->
      <div class="main col-sm-12">
        <main class="main-content" role="content" aria-label="Content">
          <!-- Slider Start -->
<section id="global-header">
  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <div class="block">
                  <h1>reThink Policy Description Language</h1>
                  <p></p>
              </div>
          </div>
      </div>
  </div>
</section>

<section>
  <div class="container main-content">
    <h1 id="rethink-policy-description-language">reThink Policy Description Language</h1>

<p>A policy describes principles or strategies for a plan of action designed to achieve a particular set of goals. We define a policy as a function that maps a series of events into a set of actions. In this section we introduce our Policy Description Language (PDL), a simple but expressive language to specify policies. PDL is specifically designed for turning the needs of access control into meaningful policies that can govern whether and where a request should be blocked, filter which elements of the returned resource it can contain, and constrain the values that can be set for properties. The reTHINK Policy Specification Language is a PDL tailored to the requirements of reTHINK framework. Policies following this language use a closed vocabulary that gives the ability to configure end user or service provider configurations in an expressive and flexible way.</p>

<h2 id="background">Background</h2>

<p>The reThink project defines a PEP/PDP model for its <a href="/specs/policy-management/service-provider/policy-engine/">policy engines</a>. As shown in Figure 1, upon the interception of a message, the PEP analyzes it and collects necessary attributes into a authorization request to PDP. The PDP then gets the right policies for the request from a database remotely or locally, evaluates the attributes against the policies, and finally responds with a decision such as <em>permit</em>, <em>deny</em>, <em>not applicable</em>, or <em>indeterminate</em>.</p>

<p><img src="./figures/pe_msging.png" alt="" /></p>

<p><strong>Figure 1:</strong> PEP-PDP interaction</p>

<ul>
  <li>A <strong>request</strong> normally contains four kinds of attributes such as Subject, Resource, Action, and Environment. Subject attribute contains subject’s details such as name, e-mail, role and so on. Resource attribute details the resource for which access is requested and action attribute specifies the requested action to be performed on resource such as read or write. Also, Environment attribute is optional and contains attributes of environment.</li>
  <li>A <strong>response</strong> represents the authorization decision information made by PDP. It contains one or more result attributes. Each result includes a decision such as permit, deny, notApplicable, or indeterminate. In addition, there might some status information which gives the errors occurred and their descriptions while evaluating the request and optionally one or more obligations which specifies tasks in the policySet and policy elements in the policy description which should be performed before or after granting or denying access.</li>
</ul>

<h2 id="pdl-structure">PDL Structure</h2>

<p>The reThink PDL contains three structural elements, namely Policy Set, Policy, and Rule. The fields of each element and the relationships between them are presented in Figure 2.</p>

<p><img src="./figures/pdl_structure.png" alt="" /></p>

<p><strong>Figure 2:</strong> Policy Language Structure</p>

<ul>
  <li>A <strong>rule</strong> element defines the target elements to which the rule is applied and details conditions to apply the rule and has three components such as target, effect, and condition. A target element specifies the resources, subjects, actions and the environment to which the rule is applied. A condition element shows the conditions to apply the rule and a effect is the consequence of the rule as either permit or deny.</li>
  <li>A <strong>policy</strong> is the set of rules which are combined with some algorithms. These algorithms are called rule-combining algorithms. For instance “Permit Override” algorithm allows the policy to evaluate to “Permit” if any rule in the policy evaluates to “Permit”. A policy also contains target elements which shows the subjects, resources, actions, environment that policy is applied.</li>
  <li>A <strong>policy set</strong> consists of Policies combined with policy-combined algorithm. It has also target like a Policy.</li>
</ul>

<h2 id="pdl-syntax">PDL Syntax</h2>

<p>Policies are expressed in JSON format with a set of key-value pairs. Following the PDL structure as mentioned above, the policies are formatted with three layers respectively: the outmost PolicySets, the inner Policies, and the innermost Rules.</p>

<h3 id="policy-sets-policies-and-rules">Policy Sets, Policies, and Rules</h3>

<p>As shown in Figure 3, for a specific PolicySet, an <strong>id</strong> is given in order to uniquely identify it, and a <strong>version</strong> field shows the current version of this PolicySet. The <strong>update</strong> field indicates the timestamp of last update. A <strong>target</strong> defines a simple Boolean condition that, if satisfied (evaluates to True) by the attributes of the request, establishes the need for subsequent evaluation against the <strong>policies</strong> in this set. If no target matches the request, the decision then would be <em>not applicable</em>, and if the target condition evaluates to True for and the policies of this set fails to evaluate for any reason, the result of this policy set would be <em>indeterminate</em>. The <strong>priority</strong> field specifies the weight of current policy set compared to others. The <strong>obligations</strong> specifies tasks that should be performed before or after granting or denying access.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;id&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;version&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;update timestamp&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;boolean condition&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"policies"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[&lt;policy1&gt;, &lt;policy2&gt;, ...]"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"policyCombiningAlgorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;algorithm&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[&lt;task1&gt;, &lt;task2&gt;, ...]"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;priority&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Figure 3:</strong> PolicySet syntax</p>

<p>Each policy, as show in Figure 4, contains id, target, priority, and obligations fields like policy set. Similarly, it contains a set of rules and combining algorithm for the evaluation of attributes contained in the request.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;id&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;boolean condition&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"rules"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[&lt;rule1&gt;, &lt;rule2&gt;, ...]"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ruleCombiningAlgorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;algorithm&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[&lt;task1&gt;, &lt;task2&gt;, ...]"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;priority&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Figure 4:</strong> Policy syntax</p>

<p>As show in Figure 5, in addition to a target, a rule includes one or a combination of Boolean conditions that, if evaluated true, have an effect of either Permit or Deny. If the target condition evaluates to True for a Rule and the Rule’s condition fails to evaluate for any reason, the effect of the Rule is Indeterminate. In comparison to the (matching) condition of a target, the conditions of a Rule or Policy are typically more complex and may include functions (e.g., “greater-than”, “less-than”, “equal”) for the comparison of attribute values, and operations (e.g., “not”, “and”, “or”) for the computation of Boolean values.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;id&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;boolean condition&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;condition&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;effect&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[&lt;task1&gt;, &lt;task2&gt;, ...]"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;priority&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Figure 5:</strong> Rule syntax</p>

<h3 id="operators-and-attributes">Operators and Attributes</h3>

<p>In a rule entry of a policy, the condition field represents the restriction under which the rule could be applied. When the policy engine examines a message, it firstly looks for the predefined policy for the message, and then compares the message against the policy rule by rule using the condition field. As depicted in the previous section, the conditions can be expressed using as many kinds of attributes as possible in order to achieve strong flexibility, expressiveness and functionality such as time, weekday, source of the message, domain, and so on. The Table 1 below lists all the supported condition attributes.</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
      <th>Expected Parameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>srcUsername</td>
      <td>username of the source of the message</td>
      <td>String, a valid email. e.g., alice@gmail.com</td>
    </tr>
    <tr>
      <td>srcIDPDomain</td>
      <td>ID domain of the source user of the message</td>
      <td>String, a valid id domain. e.g., gmail.com</td>
    </tr>
    <tr>
      <td>srcSPDomain</td>
      <td>service domain of the source of the message</td>
      <td>String, a valid service domain.</td>
    </tr>
    <tr>
      <td>srcScheme</td>
      <td>data object scheme</td>
      <td>String, a valid data object scheme. e.g., connection</td>
    </tr>
    <tr>
      <td>msgFrom</td>
      <td>source url of the message</td>
      <td>String, a valid url. e.g., domain://registry…</td>
    </tr>
    <tr>
      <td>srcIDP</td>
      <td>identity provider of the source of the message</td>
      <td>String, a valid idp</td>
    </tr>
    <tr>
      <td>msgTo</td>
      <td>destination url of the message</td>
      <td>String, a valid url. e.g., domain://registry…</td>
    </tr>
    <tr>
      <td>dstSPDomain</td>
      <td>service domain of the recipient of the message</td>
      <td>String, a valid domain. e.g., gmail.com</td>
    </tr>
    <tr>
      <td>dstScheme</td>
      <td>data object scheme</td>
      <td>String, a valid data object scheme. e.g., connection</td>
    </tr>
    <tr>
      <td>actionType</td>
      <td>type of action</td>
      <td>String. e.g., open, create, update, etc.</td>
    </tr>
    <tr>
      <td>resource</td>
      <td>targeted resource</td>
      <td>String, a valid resource. e.g., an user</td>
    </tr>
    <tr>
      <td>auth</td>
      <td>authorization status</td>
      <td>Boolean, true or false</td>
    </tr>
    <tr>
      <td>msgId</td>
      <td>id of the message</td>
      <td>Number, a valid integer. e.g., 1</td>
    </tr>
    <tr>
      <td>msgType</td>
      <td>type of the message</td>
      <td>String, a valid message type. e.g., registration</td>
    </tr>
    <tr>
      <td>time</td>
      <td>time of the day, HH:mm:ss</td>
      <td>String, a valid time. e.g., 12:30:00</td>
    </tr>
    <tr>
      <td>date</td>
      <td>date of the year, YYYY-MM-DD</td>
      <td>String, a valid date. e.g., 1992-10-23</td>
    </tr>
    <tr>
      <td>weekday</td>
      <td>day of the week</td>
      <td>String, a valid weekday. e.g., Sunday</td>
    </tr>
  </tbody>
</table>

<p><strong>Table 1:</strong> Attributes</p>

<p>The type of operation to do to verify an attribute value against a given parameter defined in policy is done through the operators such as “equals”, “moreThan”, “lessThan”, etc… The operation keyword of the condition states how the evaluation of the policy must deal with the system attribute and its parameter independently of what the system attribute is. For instance, the operation may verify if the system attribute is equal to the parameter, if it is part of a collection, or if its value is greater than or less than the parameter. The Table 2 presents operations supported by the policy engine.</p>

<table>
  <thead>
    <tr>
      <th>Operator</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>in</td>
      <td>Verifies if a given value is part of a collection</td>
    </tr>
    <tr>
      <td>equals</td>
      <td>Verifies if a given value is equal to other</td>
    </tr>
    <tr>
      <td>moreThan</td>
      <td>Verifies if a given value is greater than the other</td>
    </tr>
    <tr>
      <td>lessThan</td>
      <td>Verifies if a given value is less than the other</td>
    </tr>
    <tr>
      <td>between</td>
      <td>Verifies if a given value (including time) is within a scope</td>
    </tr>
    <tr>
      <td>contains</td>
      <td>Verifies if a given collection contains a value</td>
    </tr>
    <tr>
      <td>like</td>
      <td>Verifies if a given string fulfils a specific pattern using wildcards (one or more “*”)</td>
    </tr>
  </tbody>
</table>

<p><strong>Table 2:</strong> Operators</p>

<h3 id="targets-and-conditions">Targets and Conditions</h3>

<p>reThink PDL defines a notion of <em>Attribute Condition</em>, which is a simple Boolean condition consists of exactly an attribute, at least an operator and one or more parameters. It defines the condition that the message has to fulfil with respect to a specific attribute. Multiple <em>Attribute Conditions</em> can be integrated into a more complex condition with logical operations such as <em>not, anyOf, allOf</em>. The notion of <em>Attribution Condition</em> is used in both <em>Target</em> and <em>Condition</em> fields in the reThink PDL.</p>

<p><strong><em>Attribute Condition</em></strong></p>

<p>Attribute Condition follows the syntax as below:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"&lt;attribute&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;condition expression&gt;"</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The <em>condition expression</em> is an expression consists of operators and parameters which defines specifically the requirements that the attribute value of the message has to meet. The simplest format of the expression could be:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"&lt;operator&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter&gt;"</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>However, there are also cases that we may need multiple constrains (operator-parameter pairs)  for the same attribute, with logical relationships such as <em>and, or, not</em>. Respectively, we use keywords such as <em>allOf, anyOf</em> and <em>not</em> to indicate these relations. To simplify this, we also define that by default operator-parameter pairs in the same map are of <em>and</em> relationship, while the ones in the same array are of <em>or</em> relationship, so that in most cases that the keywords can be omitted.</p>

<ul>
  <li>
    <p><em>OR Logic</em>:</p>

    <p>e.g., expression1 <em>or</em> expression2:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nt">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">},</span><span class="w">
     </span><span class="p">{</span><span class="nt">"&lt;operator2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>

    <p>Simplification:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="nt">"&lt;operator2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span></code></pre>
    </div>

    <p>Specifically, if a complex expression contains multiple operator-parameter pairs with <em>or</em> relationship having the same operator:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter3&gt;"</span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span></code></pre>
    </div>

    <p>then it can be further simplified as:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;parameter3&gt;"</span><span class="p">]}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p><em>AND Logic</em>:</p>

    <p>e.g., expression1 <em>and</em> expression2:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"allOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="nt">"&lt;operator2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>

    <p>Simplification:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"&lt;operator2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>

    <p>Please note that we do not provide any further simplification for a complex expression that contains multiple operator-parameter pairs with <em>and</em> relationship having the same operator, i.e., there is no further simplified syntax for expression:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter2&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter3&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p><em>NOT Logic</em>:</p>

    <p>e.g., <em>not</em> expression1:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"not"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;operator1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;parameter1&gt;"</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>
  </li>
</ul>

<p>Therefore, an <em>Attribute Condition</em> could be simple but flexible and expressive as below for example:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"between"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"06:00:00 12:30:00"</span><span class="p">,</span><span class="w"> </span><span class="s2">"13:00:00 23:00:00"</span><span class="p">]}}</span><span class="w">
</span></code></pre>
</div>

<p><strong><em>Complex Condition</em></strong></p>

<p>A <em>Complex Condition</em> contains constrains in multiple attributes. Similar to <em>Attribution Condition</em>, we use keywords <em>not</em>, <em>anyOf</em>, and <em>allOf</em> to indicate logical relations and also support simplifications.</p>

<ul>
  <li>
    <p><em>OR Logic</em>:</p>

    <p>e.g., attributeCondition1 <em>or</em> attributionCondition2:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="nt">"&lt;attribute1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression1&gt;"</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;attribute2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression2&gt;"</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>

    <p>Simplification:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">[{</span><span class="nt">"&lt;attribute1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression1&gt;"</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;attribute2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression2&gt;"</span><span class="p">}]</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p><em>AND Logic</em>:</p>

    <p>e.g., attributeCondition1 <em>and</em> attributeCondition2:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"allOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="nt">"&lt;attribute1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression1&gt;"</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;attribute2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression2&gt;"</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>

    <p>Simplification:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"&lt;attribute1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression1&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"&lt;attribute2&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression2&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p><em>NOT Logic</em>:</p>

    <p>e.g., <em>not</em> attributeCondition1:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"not"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"&lt;attribute1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;expression1&gt;"</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
    </div>
  </li>
</ul>

<p>Both <em>Target</em> and <em>Condition</em> fields can be actually expressed following the syntax described above. Normally, <em>Target</em> field uses a simple <em>Attribute Condition</em> to specify the scope of the policy rules, while <em>Condition</em> field is typically more complex and may use <em>Complex Conditions</em>.</p>

<h3 id="combining-algorithms">Combining Algorithms</h3>

<p>Because a policy may contain multiple rules, and a policy set may contain multiple policies or policy sets, each rule, policy, or policy set may evaluate to different decisions (permit, deny, not applicable, or indeterminate). reThink PDL provides a way of reconciling the decisions each makes. This reconciliation is achieved through a collection of combining algorithms. Each algorithm represents a different way of combining multiple local decisions into a single global decision. There are several combining algorithms, to include the following:</p>

<ul>
  <li>Deny-overrides: if any decision evaluates to Deny, or no decision evaluates to Permit, then the result is Deny. If all decisions evaluate to Permit, the result is Permit.</li>
  <li>Permit-overrides: if any decision evaluates to Permit, then the result is Permit, otherwise the result is Deny.</li>
  <li>First-applicable: the rules are evaluated following the order given by the priority field, and the decision of the first that applies (either deny or allow), is the final result of the policy evaluation.</li>
</ul>

<p>Combining algorithms are applied to rules in a Policy and Policies within a policy set in arriving at an ultimate decision of the PDP. Combining algorithms can be used to build up increasingly complex policies. For example, given that a subject request is Permitted (by the PDP) only if the aggregate (ultimate) decision is Permit, the effect of the Permit-overrides combining algorithm is an “OR” operation on Permit (any decision can evaluate to Permit), and the effect of a Deny-overrides is an “AND” operation on Permit (all decisions must evaluate to Permit).</p>

<h3 id="obligations-and-advice">Obligations and Advice</h3>

<p>The reThink PDL includes the concepts of obligation and advice expressions. An obligation optionally specified in a Rule, Policy, or PolicySet is a directive from the PDP to the Policy Enforcement Point (PEP) on what must be carried out before or after an access request is approved or denied. Advice is similar to an obligation, except that advice may be ignored by the PEP. A few examples include:</p>

<ul>
  <li>If Alice is denied access to document X: email her manager that Alice tried to access document X.</li>
  <li>If a user is denied access to a file: inform the user why the access was denied.</li>
  <li>If a user is approved to view document X: watermark the document “DRAFT” before delivery.</li>
</ul>

<h2 id="pdl-example">PDL Example</h2>

<p>For a better understanding, Figure 6 gives an example of a policy set in JSON.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"update"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-14 17:18:31"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="nt">"policyCombiningAlgorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"firstApplicable"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"policies"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
      </span><span class="nt">"ruleCombiningAlgorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blockOverrides"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"deny"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"emailto"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@imt-atlantic.fr"</span><span class="p">}},</span><span class="w">
      </span><span class="nt">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"target"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="nt">"srcDomain"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gmail.com"</span><span class="p">}},</span><span class="w">
            </span><span class="p">{</span><span class="nt">"msgType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"create"</span><span class="p">,</span><span class="s2">"update"</span><span class="p">,</span><span class="s2">"open"</span><span class="p">,</span><span class="s2">"subscribe"</span><span class="p">,</span><span class="s2">"response"</span><span class="p">,</span><span class="w"> </span><span class="s2">"handshake"</span><span class="p">]}}],</span><span class="w">
          </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="nt">"allOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="nt">"weekday"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"not"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"saturday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sunday"</span><span class="p">]}}},</span><span class="w">
                </span><span class="p">{</span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"between"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"06:00:00 12:30:00"</span><span class="p">,</span><span class="w"> </span><span class="s2">"13:00:00 23:00:00"</span><span class="p">]}}]},</span><span class="w">
              </span><span class="p">{</span><span class="nt">"allOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="nt">"weekday"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"saturday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sunday"</span><span class="p">]}},</span><span class="w">
                </span><span class="p">{</span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"between"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"07:00:00 12:00:00"</span><span class="p">,</span><span class="w"> </span><span class="s2">"13:30:00 22:30:00"</span><span class="p">]}}]}]},</span><span class="w">
          </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"permit"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"obligations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"emailto"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@imt-atlantic.fr"</span><span class="p">},</span><span class="w">
          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Figure 6:</strong> Policy example</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="/specs/policy-management/service-provider/policy-engine/">Policy Engine in the Node.js Messaging Node of reThink</a></li>
  <li><a href="https://github.com/reTHINK-project/specs/blob/master/policy-management/policy-specification-language.md">Policy Description Language in the Runtime of reThink</a></li>
</ul>


  </div>
</section>

        </main>
      </div>
    </div>
    <!-- footer Start -->
<footer>
  <div class="container">
    <div class="row">
      <div class="subscribe col-md-8 col-md-offset-2">
        <h2>Keep in touch with us</h2>
<p></p>

<!-- <form class="form-inline">
  <div class="form-group col-md-9 col-sm-9">
    <input type="email" class="form-control" id="inputEmail" placeholder="Enter your email to update">
  </div>
  <div class="form-group col-md-3 col-sm-3">
  <button type="submit" class="btn btn-submit">SUBMIT</button>
  </div>
</form> -->
<ul class="social-media-list">
  
  <li class="social-icons"><a target="_blank" title="reTHINK-project" href="https://github.com/reTHINK-project">
  <span class="icon icon--github"><svg viewBox="0 0 16 16" width="100%" height="100%"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span>
</a>
</li>
  

  
  <li class="social-icons"><a target="_blank" title="rethink_eu" href="https://twitter.com/rethink_eu">
  <span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="100%" height="100%"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span>
</a>
</li>
  

  
  <li class="social-icons"><a target="_blank" title="rethink-project" href="https://rethink-project.slack.com">
  <span class="icon icon--slack">﻿<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" width="100%" height="100%">
<path style=" " d="M 17.65625 3 C 17.375 2.976563 17.0625 3.03125 16.78125 3.125 C 15.652344 3.503906 15.058594 4.714844 15.4375 5.84375 L 16.34375 8.5 L 11.21875 10.21875 L 10.375 7.65625 C 9.996094 6.527344 8.785156 5.933594 7.65625 6.3125 C 6.523438 6.691406 5.902344 7.902344 6.28125 9.03125 L 7.125 11.5625 L 4.46875 12.46875 C 3.339844 12.847656 2.746094 14.089844 3.125 15.21875 C 3.503906 16.347656 4.714844 16.941406 5.84375 16.5625 L 8.5 15.6875 L 10.21875 20.78125 L 7.65625 21.625 C 6.527344 22.003906 5.933594 23.214844 6.3125 24.34375 C 6.691406 25.476563 7.902344 26.097656 9.03125 25.71875 L 11.5625 24.875 L 12.46875 27.53125 C 12.847656 28.660156 14.089844 29.253906 15.21875 28.875 C 16.347656 28.496094 16.941406 27.285156 16.5625 26.15625 L 15.6875 23.5 L 20.78125 21.78125 L 21.625 24.34375 C 22.003906 25.472656 23.214844 26.066406 24.34375 25.6875 C 25.476563 25.308594 26.097656 24.097656 25.71875 22.96875 L 24.875 20.4375 L 27.53125 19.53125 C 28.660156 19.152344 29.253906 17.910156 28.875 16.78125 C 28.496094 15.652344 27.285156 15.058594 26.15625 15.4375 L 23.5 16.3125 L 21.78125 11.21875 L 24.34375 10.375 C 25.472656 9.996094 26.066406 8.785156 25.6875 7.65625 C 25.308594 6.527344 24.097656 5.902344 22.96875 6.28125 L 20.4375 7.125 L 19.53125 4.46875 C 19.246094 3.621094 18.496094 3.066406 17.65625 3 Z M 17.6875 12.59375 L 19.40625 17.6875 L 14.3125 19.40625 L 12.59375 14.3125 Z "/>
</svg>
</span>
</a>
</li>
  
</ul>

      </div>
    </div>
    <div class="row footer-footer">
      <div class="footer-menu col-md-6 col-xs-12">
        <div class="col-md-2 col-xs-2" >
          <img width="60" height="41px" src="/specs/img/ue-logo.jpg" alt="Img">
        </div>
        <div class="col-md-10 col-xs-10" >
          <p>This project has received funding from the European Horizon 2020 Programme for research, technological development and demonstration under grant agreement n° 645342
</p>
        </div>
      </div>
      <div class="footer-menu col-md-6 col-xs-12">
      <div class="row">

  <div class="col-sm-4 col-xs-12 ">
    <h5>ABOUT RETHINK</h5>
    <ul>
      
        <li><a title= " About reThink " href=" https://rethink-project.github.io/ ">About reThink</a></li>
      
        <li><a title= " Partners " href=" https://rethink-project.github.io/ ">Partners</a></li>
      
        <li><a title= " Approach " href=" https://rethink-project.github.io/ ">Approach</a></li>
      
    </ul>
  </div>
  <div class="col-sm-4 col-xs-12">
    <h5>  PUBLICATIONS </h5>
    <ul>
      
        <li><a title= " Deliverables " href=" https://rethink-project.github.io/ ">Deliverables</a></li>
      
        <li><a title= " Press " href=" https://rethink-project.github.io/ ">Press</a></li>
      
        <li><a title= " Conferences and Journals " href=" https://rethink-project.github.io/ ">Conferences and Journals</a></li>
      
    </ul>
  </div>

  <div class="col-sm-4 col-xs-12">
    <h5>  STAY TUNED </h5>
    <ul>
      
        <li><a title= " News " href=" https://rethink-project.github.io/ ">News</a></li>
      
        <li><a title= " Newsletter " href=" https://rethink-project.github.io/ ">Newsletter</a></li>
      
    </ul>
  </div>

</div>

      </div>
    </div>
  </div>
</footer>


  </body>

</html>
